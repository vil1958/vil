#assoc #ftype

![Пример ассоциации с PotPlayer](PotPlayer.md)

```
assoc .pdf=FoxitPDFReader.PDF
ftype FoxitPDFReader.PDF="d:\T\bin\View\PDF\FoxitPDFReader\FoxitPDFReaderPortable.exe" "%1"
assoc | grep pdf
ftype | grep PDF
```

В Total Commander внутренние ассоциации:
`"%COMMANDER_PATH%\bin\View\PDF\FoxitPDFReader\FoxitPDFReaderPortable.exe" "%1"`

https://ab57.ru/cmdlist/ftype.html?ysclid=lfwlezc1ri497075457

# Команда FTYPE - просмотр и изменение расширений файлов и сопоставленных им приложений

**FTYPE** используется для отображения и изменения сопоставлений типов файлов и командных строк их открытия.  
  
Формат командной строки:  
  
**FTYPE [типФайлов[=[команднаяСтрокаОткрытия]]]**  
  
Параметры командной строки:  
  
**типФайлов** - Тип файлов для просмотра или изменения сопоставления.  
  
**команднаяСтрокаОткрытия** - Команда, используемая для открытия файлов указанного типа.  
  
Команда FTYPE без параметров выводит текущий список типов файлов, для которых определены командные строки открытия. Если указан только тип файла, FTYPE выводит командную строку открытия для этого типа файлов. Если после знака равенства не указана строка открытия, FTYPE удалит текущее сопоставление для указанного типа файлов. При вызове командной строки переменные %0 и %1 заменяются на имя файла, запускаемого с помощью сопоставления. Вместо переменной %* подставляются все параметры, а переменные %2, %3 и т.д. заменяются, соответственно, на первый, второй и другие параметры. Вместо переменной %~n подставляются все оставшиеся параметры, начиная с n, где n является числом от 2 до 9. Например:  
  
**ASSOC .pl=PerlScript**  
**FTYPE PerlScript=perl.exe %1 %***  
  
Эти команды позволят вызывать обработчик команд Perl следующим образом:  
  
**script.pl 1 2 3**  
  
Если желательно избежать постоянного ввода расширения имен файлов, введите следующую команду:  
  
**set PATHEXT=.pl;%PATHEXT%**  
  
После чего, обработчик команд вызывается еще проще:  
  
**script 1 2 3**  
  
В большинстве случаев, команда **FTYPE** применяется совместно с командой **ASSOC**  
  
Примеры использования.  
  
Посмотреть, каким образом обрабатывается открытие документов **Microsoft Word**:  
  
**ASSOC .doc** - получить информацию о типе файла, ассоциированного с расширением **.doc**  
**.doc=Word.Document.8** - ответ на **ASSOC**  
**ftype word.document.8** - отобразить командную строку для открытия файлов данного типа ( .doc )  
**word.document.8="C:\Program Files\Microsoft Office\Office14\WINWORD.EXE" /n "%1"** - строка запуска приложения с параметрами для открытия файлов данного типа  
  
Удаление сопоставления типа файла и приложения:  
  
**ftype word.document.8=**  
  
Изменение сопоставления типа файла и приложения для его открытия:  
  
`ftype word.document.8="C:\Program Files\Microsoft Office\Office10\WINWORD.EXE" /n "%1"`

в TC
`*.mp4;*.avi;*.mov`
`d:\bin\Player\Video\PotPlayer\PotPlayerMini64.exe "%1"`

У меня связать расширение с PotPlayer
`PotPlayerMini64.MP4="d:\bin\Player\Video\PotPlayer\PotPlayerMini64.exe" "%1"`

`assoc .mp4=PotPlayerMini64.MP4`
`ftype PotPlayerMini64.MP4="d:\bin\Player\Video\PotPlayer\PotPlayerMini64.exe" "%1"`

===========================================================
https://habr.com/ru/post/449820/

# Мгновенная настройка привычных файловых ассоциаций

[Системное администрирование*](https://habr.com/ru/hub/sys_admin/)

Автоматизировал задание файловых ассоциаций, то есть выбор программы которая будет открывать файл из Explorer/Finder. И делюсь.

  Сначала проблематика. Файлы нужных расширений часто не открываются по умолчанию ничем, а если открываются, то каким-нибудь iTunes. Под windows нужные ассоциации, бывает, и вовсе теряются при установке (или даже деинсталяции) программ: снесёшь, бывало, GIMP, а ico-файлы перешли во владение от привычного просмотрщика файлов к стандартной Photo Gallery. Почему? Зачем? Неизвестно… А если нашёл новый редактор или, по разным причинам, свежая инсталляция? А если компьютер не один? В общем, кликать мышками в диалогах — развлечение такое себе.

Вместо этого я сохранил два файлика на Dropbox и теперь привести компьютерный мир к привычному состоянию можно почти мгновенно. И чего ждал столько лет… Далее рецепт для Windows и macOS.

  

## Windows

  

В консоли Windows `cmd.exe` это делается в два этапа:

  

```
ftype my_file_txt="C:\Windows\notepad.exe" "%1"
assoc .txt=my_file_txt
```

Изменения вступают в силу сразу. ~~Несмотря на то, что ассоциация прописывается для текущего пользователя, запускать эти команды нужно почему-то с правами администратора.~~ И не забыть задвоить символ процента (%%1) при запуске из bat-файла. Волшебный мир Windows 7 Ultimate 64-bit...
UPD. Опыты показали, что манипуляции с ftype/assoc воздействуют на всех юзеров на машине (такого поворота наша редакция не ожидала). Тем не менее, схема остаётся рабочей. Но буду выяснять как не затронуть остальных.

## Итоговый скрипт для Windows (.bat)


```
@echo off

set XNVIEW=C:\Program Files (x86)\XnView\xnview.exe
set SUBLIME=C:\Program Files\Sublime Text 3\sublime_text.exe
set FOOBAR=C:\Program Files (x86)\foobar2000\foobar2000.exe

call :assoc_ext "%SUBLIME%" txt md js json css java sh yaml
call :assoc_ext "%XNVIEW%" png gif jpg jpeg tiff bmp ico
call :assoc_ext "%FOOBAR%" flac fla ape wav mp3 wma m4a ogg ac3

goto :eof

:assoc_ext
  set EXE=%1
  shift
  :loop
  if "%1" neq "" (
    ftype my_file_%1=%EXE% "%%1"
    assoc .%1=my_file_%1
    shift
    goto :loop
  )
goto :eof
```

В дополнение: в Windows 8 и выше появилась возможность выгрузить ассоциации через dism. Сначала запускаем control /name Microsoft.DefaultPrograms, выставляем там нужные ассоциации под нужные приложения, затем делаем `dism /online /Export-DefaultAppAssociations:%filename%`. Для импорта — `dism /online /Import-DefaultAppAssociations:%filename%` 
Разумеется, ПО, которое окажется в файле экспорта. перед импортом необходимо установить, если в системе его нет